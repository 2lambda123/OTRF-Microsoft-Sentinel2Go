#!/bin/sh

# Author: Roberto Rodriguez (@Cyb3rWard0g)
# License: MIT

# We need to use sudo for commands, if not running as root
SUDO=''
if [ "$EUID" != 0 ]; then
    SUDO='sudo'
fi

# Install Docker and Docker-Compose
./Install-Docker.sh

# *********** Cloning log4shell Lab ***************
git clone https://github.com/Cyb3rWard0g/log4jshell-lab /opt/log4shell-lab

# *********** Create Docker socket proxy **********
docker network create --gateway 192.168.55.1 --subnet 192.168.55.0/24 socket_proxy

# *********** Deploy Lab Environment ***********
cd /opt/log4shell-lab
docker-compose -f docker-compose.yml up --build -d

# *********** Compile Payloads ************
# Basic Jar
cd vulnApps
docker run -it --rm -v "$(pwd)":/opt/maven -w /opt/maven maven mvn clean install